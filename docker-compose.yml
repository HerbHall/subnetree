# SubNetree - Docker Compose
#
# Quick start:
#   docker compose up -d
#
# Then open http://localhost:8080 in your browser.
# First-time setup will prompt you to create an admin account.
#
# For better network scanning on home networks, uncomment "network_mode: host"
# below and comment out the "ports:" section.

services:
  subnetree:
    image: ghcr.io/herbhall/subnetree:latest
    container_name: subnetree
    restart: unless-stopped
    ports:
      # Web UI and API
      - "8080:8080"
      # Scout agent communication (only needed if using Scout agents)
      # - "9090:9090"
    volumes:
      # All data (database, config, logs) persists here
      - subnetree-data:/data
    environment:
      # Log level: debug, info, warn, error
      - NV_LOG_LEVEL=info
    # Required for network scanning (ARP and ICMP ping)
    cap_add:
      - NET_RAW
      - NET_ADMIN
    # Uncomment for full network scanning (recommended for home networks):
    # network_mode: host
    healthcheck:
      test: ["CMD", "wget", "--no-verbose", "--tries=1", "--spider", "http://localhost:8080/healthz"]
      interval: 30s
      timeout: 5s
      retries: 3
      start_period: 10s

volumes:
  subnetree-data:
